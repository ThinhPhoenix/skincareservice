@page "/staff"
@using Microsoft.EntityFrameworkCore
@using Microsoft.AspNetCore.Components.QuickGrid
@using SkinCareBussinessObject
@using SkinCareRepository
@using System.Linq
@inject IStaffRepository StaffRepository
@inject NavigationManager NavigationManager

<PageTitle>Staff Management</PageTitle>

<div class="container mt-4">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h1 class="fw-bold text-primary"><i class="bi bi-people-fill me-2"></i>Staff Management</h1>
		<button class="btn btn-success" @onclick="@(() => NavigationManager.NavigateTo("staff/create"))">
			<i class="bi bi-plus-circle me-1"></i> Add New Staff
		</button>
	</div>

	<div class="card shadow-sm">
		<div class="card-body">
			@if (staffQuery != null && staffQuery.Any())
{
    <div class="table-responsive">
        <table class="table table-hover table-striped">
            <thead>
                <tr>
                    <th>User ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Role</th>
                    <th>Hire Date</th>
                    <th>Manager</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var staff in staffQuery)
                {
                    <tr>
                        <td>@staff.UserId</td>
                        <td>@staff.FirstName</td>
                        <td>@staff.LastName</td>
                        <td>@staff.Role</td>
                        <td>@staff.HireDate.ToString("MMM dd, yyyy")</td>
                        <td>
                            @if (staff.IsManager)
                            {
                                <span class="text-success fw-bold">✅</span>
                            }
                            else
                            {
                                <span class="text-danger fw-bold">❌</span>
                            }
                        </td>
                        <td>
                            <div class="btn-group">
                                <a href="@($"staff/details?id={staff.Id}")" class="btn btn-sm btn-info">
                                    <i class="bi bi-eye"></i> Details
                                </a>
                                <a href="@($"staff/edit?id={staff.Id}")" class="btn btn-sm btn-primary">
                                    <i class="bi bi-pencil"></i> Edit
                                </a>
                                <a href="@($"staff/delete?id={staff.Id}")" class="btn btn-sm btn-danger">
                                    <i class="bi bi-trash"></i> Delete
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
			else if (staffQuery != null && !staffQuery.Any())
			{
				<div class="text-center py-5">
					<i class="bi bi-people-fill text-secondary" style="font-size: 3rem;"></i>
					<h3 class="mt-3 text-secondary">No Staff Found</h3>
					<p class="text-muted">Get started by adding your first staff member.</p>
					<button class="btn btn-primary mt-2" @onclick="@(() => NavigationManager.NavigateTo("staff/create"))">
						Add Staff
					</button>
				</div>
			}
			else
			{
				<div class="d-flex justify-content-center py-5">
					<div class="spinner-border text-primary" role="status">
						<span class="visually-hidden">Loading...</span>
					</div>
				</div>
			}
		</div>
	</div>
</div>

@code {
	private IQueryable<Staff>? staffQuery;

	protected override void OnInitialized()
	{
		var staffList = StaffRepository.GetAll();
		staffQuery = staffList.AsQueryable();
	}


}